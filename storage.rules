rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    
    // Global Read Rule: Allows anyone to read/view files. (KEEP THIS)
    match /{allPaths=**} {
      allow read;
    }

    // Specific WRITE Rule for Profile Photos (KEEP THIS)
    match /users/{userId}/profile.jpg {
      // User must be logged in AND the userId in the path must match the logged-in user's UID.
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // âœ¨ NEW RULE: Specific WRITE Rule for Post Photos
    match /posts/{userId}/{allFiles=**} {
      // User must be logged in AND the userId in the path must match the logged-in user's UID.
      // This prevents User A from uploading files into User B's post folder.
      allow write: if request.auth != null && request.auth.uid == userId;
    }
  }
}